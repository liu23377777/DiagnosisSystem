<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>诊断详情 - 中医智能诊断系统</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        body { background-color: #f8f9fa; padding-top: 2rem; }
        .card { border: none; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .label { color: #6c757d; font-size: 0.9rem; }
        .value { font-size: 1rem; }
        .img-preview { width: 100%; max-height: 420px; object-fit: contain; background: #fff; border-radius: 8px; }
        .badge-status { font-size: 0.85rem; }
        pre { white-space: pre-wrap; word-break: break-word; }
    </style>
</head>
<body>
<div class="container">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0"><i class="bi bi-file-earmark-medical me-2"></i>诊断详情</h2>
        <div class="d-flex gap-2">
            <a href="/patient/records" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-1"></i>返回记录
            </a>
            <a href="/patient/home" class="btn btn-outline-secondary">返回首页</a>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-lg-5">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h5 class="mb-0">舌象图片</h5>
                        <span class="badge text-bg-secondary badge-status" th:if="${diagnosis.status == null}">未知</span>
                        <span class="badge text-bg-warning badge-status" th:if="${diagnosis.status != null and diagnosis.status != 1}">待审核</span>
                        <span class="badge text-bg-success badge-status" th:if="${diagnosis.status != null and diagnosis.status == 1}">已完成</span>
                    </div>
                    <img class="img-preview" th:src="${diagnosis.imageUrl}" alt="舌象图"/>
                    <div class="mt-3">
                        <div class="label">诊断时间</div>
                        <div class="value" th:text="${diagnosis.createTime}">-</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-7">
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="mb-3">基础舌象</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="label">舌色</div>
                            <div class="value" th:text="${diagnosis.tongueColor}">-</div>
                        </div>
                        <div class="col-md-6">
                            <div class="label">舌形</div>
                            <div class="value" th:text="${diagnosis.tongueShape}">-</div>
                        </div>
                        <div class="col-md-6">
                            <div class="label">舌苔颜色</div>
                            <div class="value" th:text="${diagnosis.coatingColor}">-</div>
                        </div>
                        <div class="col-md-6">
                            <div class="label">舌苔质地</div>
                            <div class="value" th:text="${diagnosis.coatingQuality}">-</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="mb-3">AI 诊断</h5>
                    <div class="mb-3">
                        <div class="label">证型</div>
                        <div class="value" th:text="${diagnosis.syndrome}">-</div>
                    </div>
                    <div class="mb-3">
                        <div class="label">病机分析</div>
                        <pre class="value mb-0" th:text="${diagnosis.pathogenesis}">-</pre>
                    </div>
                    <div>
                        <div class="label">调理建议</div>
                        <pre class="value mb-0" th:text="${diagnosis.advice}">-</pre>
                    </div>
                </div>
            </div>

            <div class="card" th:if="${diagnosis.status != null and diagnosis.status == 1}">
                <div class="card-body">
                    <h5 class="mb-3">医生复核</h5>
                    <div class="mb-3">
                        <div class="label">最终诊断</div>
                        <div class="value" th:text="${diagnosis.finalSyndrome}">-</div>
                    </div>
                    <div>
                        <div class="label">最终建议</div>
                        <pre class="value mb-0" th:text="${diagnosis.finalAdvice}">-</pre>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

